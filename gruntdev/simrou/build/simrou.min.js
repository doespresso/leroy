/*
 Simrou v1.5.2 - Released under the MIT License.
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(){var i,k,m=function(b,a){return function(){return b.apply(a,arguments)}},l={}.hasOwnProperty,n=[].slice;k=function(){function b(a){this.handleFormSubmit=m(this.handleFormSubmit,this);this.resolveHash=m(this.resolveHash,this);this.routes={};this.observeForms=this.observeHash=this.listening=!1;null!=a&&this.addRoutes(a)}b.prototype.RegExpCache={extractHash:/^[^#]*(#.*)$/,trimHash:/^#*(.*?)\/*$/};b.prototype.eventSupported=function(){var a;a=window.document.documentMode;return"onhashchange"in
window&&(null==a||7<a)}();b.prototype.addRoute=function(a,c){var f;null==c&&(c=!0);f=a instanceof i?a:new i(a,c);return this.routes[f.toString()]=f};b.prototype.addRoutes=function(a,c){var f,g,e,b;null==c&&(c=!0);if(jQuery.isFunction(a))g=a.call(this,c);else if(jQuery.isArray(a)){g=[];f=0;for(e=a.length;f<e;f++)b=a[f],g.push(this.addRoutes(b,c))}else if(jQuery.isPlainObject(a))for(e in g={},a)l.call(a,e)&&(f=a[e],b=this.addRoute(e,c),b.attachActions(f),g[e]=b);else g=this.addRoute(a,c);return g};
b.prototype.removeRoute=function(a){a instanceof i||(a=new i(a));a=a.toString();if(a in this.routes)return delete this.routes[a]};b.prototype.navigate=function(a){var c;c=this.getHash();location.hash=a;if(!this.observeHash||location.hash===c)return this.resolve(a,"get")};b.prototype.resolve=function(a,c){var f,g,b,d,h;g=(""+a).replace(this.RegExpCache.trimHash,"$1");if(""===g){if(-1===(""+a).indexOf("/"))return!1;g="/"}h=this.routes;for(b in h)if(l.call(h,b)&&(f=h[b],f instanceof i&&(d=f.match(g))))return g=
[d,c],f=jQuery(f),f.trigger("simrou:any",g),null!=c&&"any"!==c&&f.trigger("simrou:"+c.toLowerCase(),g),!0;return!1};b.prototype.getHash=function(a){null==a&&(a=location.hash);return(""+a).replace(this.RegExpCache.extractHash,"$1")};b.prototype.resolveHash=function(a){var c;if(this.observeHash)return this.eventSupported&&(c=a.originalEvent.newURL),a=this.getHash(c),this.resolve(a,"get")};b.prototype.handleFormSubmit=function(a){var c,f;this.observeForms&&(c=jQuery(a.target),f=c.attr("method")||c.get(0).getAttribute("method"),
c=this.getHash(c.attr("action")),this.resolve(c,f)&&a.preventDefault());return!0};b.prototype.listen=function(){var a=this;if(!this.listening)return jQuery(window).on("hashchange.simrou",this.resolveHash),jQuery(function(){return jQuery("body").on("submit.simrou","form",a.handleFormSubmit)}),this.listening=!0};b.prototype.start=function(a,c,f){this.observeHash=null!=c?c:!0;this.observeForms=null!=f?f:!0;(this.observeHash||this.observeForms)&&this.listen();c=this.getHash();if(""!==c)return this.resolve(c,
"get");if(null!=a)return null!=window.history&&null!=window.history.replaceState?(window.history.replaceState({},document.title,"#"+a.replace(/^#+/,"")),this.resolve(a,"get")):this.navigate(a)};b.prototype.stop=function(){return this.observeForms=this.observeHash=!1};return b}();i=function(){function b(c,a){var b,e;this.pattern=c;this.caseSensitive=null!=a?a:!0;c=""+this.pattern;e=c.match(this.RegExpCache.allParams);if(null!=e){var d,h,j;j=[];d=0;for(h=e.length;d<h;d++)b=e[d],j.push(b.substr(1));
this.params=j}else this.params=[];c=c.replace(this.RegExpCache.escapeRegExp,"\\$&");c=c.replace(this.RegExpCache.namedParam,"([^/]+)");c=c.replace(this.RegExpCache.splatParam,"(.*?)");this.expr=RegExp("^"+c+"$",a?"":"i")}var a;b.prototype.RegExpCache={escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,namedParam:/:(\w+)/g,splatParam:/\*(\w+)/g,firstParam:/(:\w+)|(\*\w+)/,allParams:/(:|\*)\w+/g};b.prototype.match=function(c){var a,b,e,d,h,j;a=this.expr.exec(c);if(jQuery.isArray(a)){e={};j=this.params;c=d=0;for(h=
j.length;d<h;c=++d)b=j[c],e[b]=a[c+1]}else e=!1;return e};b.prototype.assemble=function(){var c,a,b;b=1<=arguments.length?n.call(arguments,0):[];if(0<b.length)if(jQuery.isArray(b[0]))b=b[0];else if(jQuery.isPlainObject(b[0])){var e,d,h;d=this.params;h=[];a=0;for(e=d.length;a<e;a++)c=d[a],h.push(c in b[0]?b[0][c]:"");b=h}for(c=""+this.pattern;this.RegExpCache.firstParam.test(c);)a=0<b.length?b.shift():"",jQuery.isFunction(a)&&(a=a(this)),c=c.replace(this.RegExpCache.firstParam,""+a);return c};b.prototype.toString=
function(){return""+this.pattern};b.prototype.attachAction=function(a,b){null==b&&(b="any");return jQuery(this).on("simrou:"+b.toLowerCase(),a)};b.prototype.attachActions=function(a,b){var g,e,d;null==b&&(b="any");jQuery.isPlainObject(a)||(d=[{},a],a=d[0],d=d[1],a[b]=d);d=[];for(b in a)l.call(a,b)&&(e=a[b],jQuery.isArray(e)||(e=[e]),d.push(function(){var a,c,d;d=[];a=0;for(c=e.length;a<c;a++){g=e[a];d.push(this.attachAction(g,b))}return d}.call(this)));return d};b.prototype.detachAction=function(a,
b){var g;null==b&&(b="any");"string"===typeof a&&(b=a);g="simrou:"+b.toLowerCase();return jQuery.isFunction(a)?jQuery(this).off(g,a):jQuery(this).off(g)};a=function(a){return function(b){return this.attachAction(b,a)}};b.prototype.get=a("get");b.prototype.post=a("post");b.prototype.put=a("put");b.prototype["delete"]=a("delete");b.prototype.any=a("any");return b}();k.Route=i;window.Simrou=jQuery.Simrou=k}).call(this);
